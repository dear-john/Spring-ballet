//做了一上午也没ac，总是wa，估计是自己想的排序有问题

//sort排序不止数组，结构体也可以，自己定义比较函数就好了

#include<iostream>
#include<string>
#include<algorithm>
using namespace std;
int n;
int passnum;
struct Stud{
	string name;
	int score;
	int ispass;
}stud[1001];

bool cmp(Stud a,Stud b){
	if(a.score>b.score)return true;
	if(a.score==b.score&&a.name<b.name)return true;
	return false;
}
int main(){
	//
	int m,line;
	int fz[11];
	int i,t,k;
	while(cin>>n){
		if(n==0)break;
		for(i=0;i<n;i++){
			stud[i].score=0;
			stud[i].ispass=0;
		}
		passnum=0;
		cin>>m>>line;
		for(i=1;i<=m;i++)
			cin>>fz[i];
		for(i=0;i<n;i++){
			cin>>stud[i].name;
			cin>>k;
			while(k--){
				cin>>t;
				stud[i].score+=fz[t];
			}
			if(stud[i].score>=line){
				passnum++;
				stud[i].ispass=1;
			}		
		}
		cout<<passnum<<endl;
		sort(stud,stud+n,cmp);
		for(i=0;i<n;i++){
			if(stud[i].ispass==1){
				cout<<stud[i].name<<" "<<stud[i].score<<endl;
			}
		}
	}
	//
	return 0;
}
